<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<!-- Container start-->
<div id="container">
    <!--/*@thymesVar id="usersDto" type="ru.aora.erp.presentation.entity.dto.user.UsersDto"*/-->
    <div class="wrapper" th:fragment="kss" th:object="${ksDto}" >
        <div id="module">
            <!--header options start-->
            <div class="module_header size_is">
                <div class="container">
                    <div class="row">
                        <div class="col_xxs_12 col_xs_12 col_s_12 col_m_8 col_l_8">
                            <div class="module_title"><a href="#" th:onclick="getFragmentAndChangeDiv('#content','/counteragent')">Гарантийка</a> <i class="fal fa-arrow-right"></i> <a href="#" th:onclick="getFragmentParamAndChangeDiv('#content','/contract',[[${id_grand_parent}]],[[${id_grand_parent}]],[[${counteragent_name}]],[[${counteragent_name}]],0)"><strong  th:text="${counteragent_name}"></strong></a> <i class="fal fa-arrow-right"></i> <strong th:text="'ДОГОВОР № '+${contract_name}"></strong> <i class="fal fa-arrow-right"></i> Все справки КС-3</div>
                        </div>

                        <div class="col_xxs_12 col_xs_12 col_s_12 col_m_4 col_l_4">
                            <div class="module_actions">
                                <label class="switcher ttp_bt" title="Добавить в лаунчпад">
                                    <input type="checkbox" class="www" />

                                    <div class="signs">
                                        <i class="fas fa-rocket"></i>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--header options end-->


            <!--general container options start-->



            <div class="container">
                <div class="row">
                    <div class="col_xxs_12 col_xs_12 col_s_12 col_m_12 col_l_12">
                        <ul class="module_menu">
                            <li class="sep_right">
                                <a href="#" class="toggle_cb" th:data-toggle="'addKS'">
                                    <i class="fas fa-user-plus"></i> Добавить КС-3
                                </a>
                            </li>
                        </ul>

                        <ul class="module_menu">
                            <form method="get">
                                <li>
                                    <div class="name">С отмеченными:</div>
                                </li>

                                <li>
                                    <select name="someselect">
                                        <option disabled>Выберите действие</option>
                                        <option data-display="&lt;i class=&quot;fas fa-archive&quot;&gt;&lt;/i&gt; Архивировать">Архивировать</option>
                                        <option data-display="&lt;i class=&quot;fas fa-trash-alt&quot;&gt;&lt;/i&gt; Удалить">Удалить</option>
                                    </select>
                                </li>

                                <li>
                                    <a href="#" class="toggle_cb" th:onclick="getFragmentAndChangeDiv('#content','/garantsorted')">Список гарантиек к возврату</a>
                                </li>
                                <li>
                                    <a href="#" class="toggle_cb" th:onclick="getFragmentParamAndChangeDiv('#content','/ks',[[${id_grand_parent}]],[[${id_parent}]],[[${contract_name}]],[[${counteragent_name}]],0)">Применить</a>
                                </li>


                            </form>
                        </ul>
                    </div>
                </div>
            </div>
            <!--general container options end-->

            <!-- Add KS menu-->
            <div th:class="'addKS'+' edit hide_me'"  th:object="${ksDto}">
                <div class="row no_gutter">
                    <div class="col_xxs_12 col_xs_12 col_s_12 col_m_12 col_l_12">
                        <a th:name="'addKS'"></a>
                        <div class="add_KS">
                            <a href="javascript:;" class="toggle_cb"
                               th:data-toggle="'addKS'"><i class="far fa-times-circle"></i></a>
                        </div>
                    </div>
                    <div class="col_xxs_12 col_xs_12 col_s_12 col_m_6 col_l_6 push_m_3 push_l_3">
                        <div class="add_basic"
                             th:id ="'addKS'" action="#" th:object="${ksDto}">
                            <!--th:hidden="'false'"<form action="#" th:action="@{submitData}" class="saveForm" method="post" th:object="${counteragents}">-->
                            <label class="fld filler">
                                <em>Дата справки КС-3</em>
                                <div class="sign"><i class="fas fa-user"></i></div>
                                <input type="date" class="inp"  th:id ="'ks_date'"  name="ks_date"  th:value="''"/>
                            </label>
                            <label class="fld filler">
                                <em>Номер справки КС-3</em>
                                <div class="sign"><i class="fas fa-user"></i></div>
                                <input type="text" class="inp" th:id ="'ks_number'" name="ks_number" th:value="''"/>
                            </label>
                            <label class="fld filler">
                                <em>Сумма по справке КС-3</em>
                                <div class="sign"><i class="fas fa-user"></i></div>
                                <input type="text" class="inp" th:id ="'ks_sum'" name="ks_sum" th:value="''"/>
                            </label>
                            <label class="fld filler">
                                <em>Сумма гарантийного платежа</em>
                                <div class="sign"><i class="fas fa-user"></i></div>
                                <input type="text" class="inp" th:id ="'garant_sum'" name="garant_sum" th:value="''"/>
                            </label>
                            <label class="fld filler">
                                <em>Дата возврата гарантийного платежа</em>
                                <div class="sign"><i class="fas fa-user"></i></div>
                                <input type="date" class="inp" th:id ="'garant_date'" name="garant_date" th:value="''"/>
                            </label>
                            <label class="radiocheck">
                                <input th:type="radio" th:id="'payment_switcher_add'" th:name="'payment_switcher_add'" class="www" th:checked="'true'" th:value="'false'"/>
                                <strong>Не погашено</strong>
                            </label>

                            <label class="radiocheck">
                                <input th:type="radio" th:id="'payment_switcher_add'" th:name="'payment_switcher_add'" class="www" th:checked="'false'" th:value="'true'"/>
                                <strong>Погашено</strong>
                            </label>
                            <div class="clear_after">
                                <button th:onclick="saveKSRequest([[${id_parent}]],[[${id_grand_parent}]],[[${contract_name}]],[[${counteragent_name}]])" name="addKS" value="addKS" class="bttn bttn_submit bttn_40 right rds_5" th:data-toggle="'addKS'" >Сохранить</button>
                                <a href="javascript:;" th:onclick="getFragmentParamAndChangeDiv('#content','/ks',[[${id_grand_parent}]],[[${id_parent}]],[[${contract_name}]],[[${counteragent_name}]],0)" class="bttn bttn_40 right rds_5 toggle_cb" th:data-toggle="'addKS'">Закрыть</a>
                            </div>

                        </div>
                    </div>
                </div>
            </div>


            <!--main cycle start-->

            <div class="module_content module_guarantee">
                <div class="container">
                    <div class="row">

                        <div  th:each="ks, iterstat : ${ksDto.getKsDto()}">
                            <!-- If operator start-->

                            <div th:switch="${ks.contractId}">
                                <!-- Our company case-->

                                <div th:case="${id_parent}">
                                    <div th:if="${ks.id==null}"></div>
                                    <div th:unless="${ks.id==null}">
                                        <div class="col_xxs_12 col_xs_12 col_s_12 col_m_12 col_l_12">
                                            <div class="item clr_b2">
                                                <div class="title">
                                                    <label class="radiocheck">
                                                        <input type="checkbox" class="www" />

                                                        <strong th:text="'КС № '+${ks.ksNumber}"></strong>
                                                    </label>

                                                    <div class="more docs animate_150">
                                                        <a href="javascript:;" th:text="'От '+${ks.ksDate}"></a>
                                                        <a href="javascript:;" class="toggle_cb" th:data-toggle="'details_'+${ks.id}">Показать детали</a>
                                                    </div>

                                                    <a href="javascript:;" class="bookmark rds_full">
                                                        <i class="far fa-bookmark"></i>
                                                    </a>

                                                    <a href="javascript:;" class="actions show_popover rds_full" th:data-popover="'actions_'+${ks.id}" data-popover-position="left">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </a>

                                                    <div class="hide_me">
                                                        <div th:id="'actions_'+${ks.id}">
                                                            <ul class="popover_menu">
                                                                <li><a href="javascript:;"><i class="fas fa-paw"></i> <strong> <div th:text="'Справка КС-3 № '+${ks.ksNumber}"></div></strong></a></li>
                                                                <li><a href="#" class="toggle_cb" th:data-toggle="'KS_edit_'+${ks.id}"><i class="fas fa-user-edit"></i> Изменить</a></li>
                                                                <li><a href="javascript:;" th:onclick="deleteKS('/ks/',[[${ks.id}]],[[${id_grand_parent}]],[[${id_parent}]],[[${contract_name}]],[[${counteragent_name}]])"><i class="fas fa-trash-alt"></i> Удалить</a></li>
                                                            </ul>
                                                        </div>
                                                    </div>

                                                    <div th:class="'details details_'+${ks.id}+' edit hide_me'">

                                                        <span><strong th:text="'Сумма по КС-3 составляет '+${ks.ksSum}+' руб.'"></strong></span>

                                                        <span><strong th:text="'Сумма гарантийного платежа составляет '+${ks.garantSum}+' руб.'"></strong></span>

                                                        <span><strong th:text="'Срок погашения гарантийного платежа '+${ks.garantDate}+'. Осталось дней до погашения: '+${ks.daysToGarantDate}"></strong></span>
                                                        <div th:switch="${ks.paymentStatus}">
                                                            <div th:case="false">
                                                                <span><strong>Статус гарантийного платежа: НЕ ПОГАШЕН</strong></span>
                                                            </div>
                                                            <div th:case="true">
                                                                <span><strong>Статус гарантийного платежа: ПОГАШЕН</strong></span>
                                                            </div>
                                                        </div>

                                                    </div>

                                                    <!-- Edit KS start-->
                                                    <div th:class="'KS_edit_'+*{id}+' edit hide_me'" th:object="${ks}">
                                                        <div class="row no_gutter">
                                                            <div class="col_xxs_12 col_xs_12 col_s_12 col_m_12 col_l_12">
                                                                <a th:name="'KS_edit_'+*{id}"></a>
                                                                <div class="KS_edit">
                                                                    Изменение формы справки КС-3
                                                                    <span> <a th:text="*{ksNumber}"></a></span>
                                                                    <a href="javascript:;" class="toggle_cb"
                                                                       th:data-toggle="'KS_edit_'+*{id}"><i class="far fa-times-circle"></i></a>
                                                                </div>
                                                            </div>
                                                            <div class="col_xxs_12 col_xs_12 col_s_12 col_m_6 col_l_6 push_m_3 push_l_3">

                                                                <div class="edit_basic"
                                                                     th:id ="'form_KS_edit_'+*{id}"
                                                                     action="#"
                                                                     th:object="${ks}">
                                                                    <label class="fld filler">
                                                                        <em>Дата справки КС-3</em>
                                                                        <div class="sign"><i class="fas fa-user"></i></div>
                                                                        <input type="date" class="inp"  th:id ="'ks_date_'+*{id}"  name="ks_date"  th:value="*{ksDate}" />
                                                                    </label>
                                                                    <label class="fld filler">
                                                                        <em>Номер справки КС-3</em>
                                                                        <div class="sign"><i class="fas fa-user"></i></div>
                                                                        <input type="text" class="inp" th:id ="'ks_number_'+*{id}" name="ks_number" th:value="*{ksNumber}"/>
                                                                    </label>
                                                                    <label class="fld filler">
                                                                        <em>Сумма по справке КС-3</em>
                                                                        <div class="sign"><i class="fas fa-user"></i></div>
                                                                        <input type="text" class="inp" th:id ="'ks_sum_'+*{id}" name="ks_sum" th:value="*{ksSum}"/>
                                                                    </label>
                                                                    <label class="fld filler">
                                                                        <em>Сумма гарантийного платежа</em>
                                                                        <div class="sign"><i class="fas fa-user"></i></div>
                                                                        <input type="text" class="inp" th:id ="'garant_sum_'+*{id}" name="garant_sum" th:value="*{garantSum}"/>
                                                                    </label>
                                                                    <label class="fld filler">
                                                                        <em>Дата возврата гарантийного платежа</em>
                                                                        <div class="sign"><i class="fas fa-user"></i></div>
                                                                        <input type="date" class="inp" th:id ="'garant_date_'+*{id}" name="garant_date" th:value="*{garantDate}"/>
                                                                    </label>
                                                                    <!--<form action="#"
                                                                          th:action="@{/getPaymentStatusRadio}"
                                                                          th:object="${ksDto}" method="put">-->
                                                                    <em>Статус гарантийного платежа</em>
                                                                    <div th:switch="${ks.paymentStatus}">
                                                                        <div th:case="false">
                                                                            <label class="radiocheck">
                                                                                <input th:type="radio" th:id="'payment_switcher_'+${ks.id}" th:name="'payment_switcher_'+${ks.id}" class="www" th:checked="'true'" th:value="'false'"/>
                                                                                <strong>Не погашено</strong>
                                                                            </label>

                                                                            <label class="radiocheck">
                                                                                <input th:type="radio" th:id="'payment_switcher_'+${ks.id}" th:name="'payment_switcher_'+${ks.id}" class="www" th:checked="'false'" th:value="'true'"/>
                                                                                <strong>Погашено</strong>
                                                                            </label>
                                                                        </div>
                                                                        <div th:case="true">
                                                                            <label class="radiocheck">
                                                                                <input th:type="radio" th:id="'payment_switcher_'+${ks.id}" th:name="'payment_switcher_'+${ks.id}" class="www" th:checked="'false'" th:value="'false'"/>
                                                                                <strong>Не погашено</strong>
                                                                            </label>
                                                                            <label class="radiocheck">
                                                                                <input th:type="radio" th:id="'payment_switcher_'+${ks.id}" th:name="'payment_switcher_'+${ks.id}" class="www" th:checked="'true'" th:value="'true'"/>
                                                                                <strong>Погашено</strong>
                                                                            </label>
                                                                        </div>
                                                                    </div>


                                                                    <div class="clear_after" th:id ="'KS_id_'+*{id}" th:value="*{id}">
                                                                        <button th:onclick="updateKSRequest([[*{id}]],[[${id_parent}]],[[${id_grand_parent}]],[[${contract_name}]],[[${counteragent_name}]])" name="KS_edit" value="KS_edit" class="bttn bttn_submit bttn_40 right rds_5" th:data-toggle="'KS_edit_'+${ks.id}">Сохранить</button>
                                                                        <a href="javascript:;" th:onclick="getFragmentParamAndChangeDiv('#content','/ks',[[${id_grand_parent}]],[[${id_parent}]],[[${contract_name}]],[[${counteragent_name}]],0)" class="bttn bttn_40 right rds_5 toggle_cb" th:data-toggle="'KS_edit_'+${ks.id}">Закрыть</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>
                                                    <!-- Edit KS END-->

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <!--main cycle end-->
        </div>

    </div>


    <div class="shadow top animate_150"></div>
    <div class="shadow bot animate_150"></div>

</div>



<!-- Container end -->


